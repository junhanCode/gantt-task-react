# 国际化 (i18n) 功能实现文档

## 概述

为 Gantt Task React 组件库添加了内置的国际化支持，通过 `language` 属性控制界面语言，支持繁体中文和英文。

## 功能特性

### 1. 支持的语言

- **繁体中文** (`zh-TW`) - 默认语言
- **English** (`en`)

### 2. 国际化的文本内容

以下界面元素已支持国际化：

#### 时间轴表头
- 周标签：`第X周` / `Week X`

#### 左侧表格表头
- 任务标题：`任務標題` / `Task Title`
- 状态：`狀態` / `Status`
- 负责人：`負責人` / `Assignee`
- 操作：`操作` / `Operations`

#### 时间列标题
- 计划开始：`計劃開始` / `Planned Start`
- 计划结束：`計劃結束` / `Planned End`
- 计划时长：`計劃時長` / `Planned Duration`
- 实际开始：`實際開始` / `Actual Start`
- 实际结束：`實際結束` / `Actual End`

#### 其他文本
- 全选：`全選` / `Select All`
- 未读：`未讀` / `Unread`
- 天：`天` / `days`
- 日：`日` / `day`

## 使用方法

### 基本用法

```tsx
import { Gantt, Language } from 'gantt-task-react';

function App() {
  const [language, setLanguage] = React.useState<Language>('zh-TW');

  return (
    <>
      {/* 语言切换按钮 */}
      <button onClick={() => setLanguage('zh-TW')}>繁體中文</button>
      <button onClick={() => setLanguage('en')}>English</button>
      
      {/* Gantt 组件 */}
      <Gantt
        tasks={tasks}
        language={language}
        // ... 其他属性
      />
    </>
  );
}
```

### 属性说明

| 属性名 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `language` | `'zh-TW' \| 'en'` | `'zh-TW'` | 界面语言设置 |

## 实现细节

### 文件结构

```
src/
├── i18n/
│   └── index.ts          # 国际化配置和文本定义
├── types/
│   └── public-types.ts   # 添加 Language 类型
└── components/
    ├── gantt/
    │   └── gantt.tsx     # 接收 language 属性并传递给子组件
    ├── calendar/
    │   └── calendar.tsx  # 时间轴表头国际化
    └── task-list/
        └── oa-task-list-header.tsx  # 表格表头国际化
```

### 核心实现

1. **i18n 配置文件** (`src/i18n/index.ts`)
   - 定义 `I18nTexts` 接口
   - 实现繁体中文和英文的文本映射
   - 导出 `getI18nTexts()` 函数

2. **类型定义** (`src/types/public-types.ts`)
   - 导出 `Language` 类型
   - 在 `GanttProps` 中添加 `language` 属性

3. **组件集成**
   - `gantt.tsx`: 使用 `useMemo` 获取 i18n 文本，并传递给子组件
   - `calendar.tsx`: 时间轴周标签使用 `i18n.weekLabel()`
   - `oa-task-list-header.tsx`: 表头文本使用 i18n 对象

## 扩展指南

### 添加新语言

1. 在 `src/i18n/index.ts` 中：

```typescript
// 1. 更新 Language 类型
export type Language = 'zh-TW' | 'en' | 'ja';  // 添加日语

// 2. 定义日语文本
const ja: I18nTexts = {
  week: '週',
  weekLabel: (weekNum: string) => `第${weekNum}週`,
  // ... 其他文本
};

// 3. 更新 getI18nTexts 函数
export const getI18nTexts = (language: Language = 'zh-TW'): I18nTexts => {
  switch (language) {
    case 'en': return en;
    case 'ja': return ja;
    default: return zhTW;
  }
};
```

2. 更新 `src/types/public-types.ts` 中的 `Language` 类型：

```typescript
export type Language = 'zh-TW' | 'en' | 'ja';
```

### 添加新的国际化文本

在 `src/i18n/index.ts` 的 `I18nTexts` 接口中添加新字段：

```typescript
export interface I18nTexts {
  // 现有字段...
  
  // 新增字段
  save: string;
  cancel: string;
}

// 在每个语言对象中添加对应翻译
const zhTW: I18nTexts = {
  // ...
  save: '儲存',
  cancel: '取消',
};

const en: I18nTexts = {
  // ...
  save: 'Save',
  cancel: 'Cancel',
};
```

## 注意事项

1. **向后兼容**: 默认语言为繁体中文，不指定 `language` 属性时保持原有行为
2. **优先级**: 当同时提供 `language` 和自定义文本（如 `operationsColumnLabel`）时，优先使用自定义文本
3. **性能优化**: 使用 `useMemo` 缓存 i18n 对象，避免不必要的重渲染

## 示例

Demo 应用 (`example/src/App.tsx`) 中已集成语言切换功能，包括：
- 语言切换按钮（繁體中文 / English）
- 动态切换界面语言
- 保留所有原有功能

运行 Demo:
```bash
cd example
npm install
npm start
```
